<!DOCTYPE html>
<html>
<head>
    <title>Test JavaScript Errors</title>
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <script>
        // Capture and display all JavaScript errors
        window.addEventListener('error', function(e) {
            console.error('JavaScript Error:', {
                message: e.message,
                source: e.filename,
                line: e.lineno,
                column: e.colno,
                error: e.error
            });
            
            // Create a visible error display
            const errorDiv = document.createElement('div');
            errorDiv.style.cssText = 'background: red; color: white; padding: 10px; margin: 5px; border-radius: 5px; font-family: monospace;';
            errorDiv.innerHTML = `
                <strong>JavaScript Error:</strong><br>
                Message: ${e.message}<br>
                Source: ${e.filename}<br>
                Line: ${e.lineno}:${e.colno}<br>
                Stack: ${e.error ? e.error.stack : 'No stack trace'}
            `;
            document.body.appendChild(errorDiv);
        });
        
        // Capture unhandled promise rejections
        window.addEventListener('unhandledrejection', function(e) {
            console.error('Unhandled Promise Rejection:', e.reason);
            
            const errorDiv = document.createElement('div');
            errorDiv.style.cssText = 'background: orange; color: white; padding: 10px; margin: 5px; border-radius: 5px; font-family: monospace;';
            errorDiv.innerHTML = `
                <strong>Promise Rejection:</strong><br>
                Reason: ${e.reason}<br>
                ${e.reason && e.reason.stack ? 'Stack: ' + e.reason.stack : ''}
            `;
            document.body.appendChild(errorDiv);
        });
        
        console.log('âœ… Error tracking initialized');
    </script>
</head>
<body>
    <h1>JavaScript Error Testing</h1>
    <p>This page captures and displays JavaScript errors. Check console and this page for any errors.</p>
    
    <div style="margin: 20px 0;">
        <a href="/admin/departments/la-paz/edit" style="padding: 10px; background: blue; color: white; text-decoration: none; border-radius: 5px;">
            Go to Department Edit Page
        </a>
    </div>
    
    <div id="error-container"></div>
</body>
</html>